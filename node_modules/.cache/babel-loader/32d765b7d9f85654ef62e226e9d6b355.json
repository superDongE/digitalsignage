{"ast":null,"code":"import _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = _Reflect$construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false; if (_Reflect$construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(_Reflect$construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/**\n * @fileoverview Shows the display frame and renders all the\n * widgets inside of it\n */\nimport React from 'react';\nimport GridLayout from 'react-grid-layout';\nimport socketIOClient from 'socket.io-client';\nimport _ from 'lodash';\nimport { view } from 'react-easy-state';\nimport Frame from './Frame.js';\nimport HeightProvider from '../Widgets/HeightProvider';\nimport Widgets from '../../widgets';\nimport EmptyWidget from '../Widgets/EmptyWidget';\nimport { getDisplay } from '../../actions/display';\nvar DEFAULT_STATUS_BAR = [];\nvar DEFAULT_LAYOUT = 'spaced';\n\nvar Display = /*#__PURE__*/function (_React$Component) {\n  _inherits(Display, _React$Component);\n\n  var _super = _createSuper(Display);\n\n  function Display(props) {\n    var _this;\n\n    _classCallCheck(this, Display);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"refresh\", function () {\n      var display = _this.props.display;\n      return getDisplay(display).then(function (_ref) {\n        var _ref$widgets = _ref.widgets,\n            widgets = _ref$widgets === void 0 ? [] : _ref$widgets,\n            layout = _ref.layout,\n            _ref$statusBar = _ref.statusBar,\n            statusBar = _ref$statusBar === void 0 ? DEFAULT_STATUS_BAR : _ref$statusBar;\n\n        _this.setState({\n          widgets: widgets,\n          layout: layout,\n          statusBar: statusBar\n        });\n      });\n    });\n\n    _this.state = {\n      widgets: [],\n      layout: DEFAULT_LAYOUT,\n      statusBar: DEFAULT_STATUS_BAR\n    };\n    _this.throttledRefresh = _.debounce(_this.refresh, 1500);\n    return _this;\n  }\n\n  _createClass(Display, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.refresh();\n      var _this$props$host = this.props.host,\n          host = _this$props$host === void 0 ? 'http://localhost' : _this$props$host;\n      var socket = socketIOClient(host);\n      socket.on('admin:update', function () {\n        return _this2.throttledRefresh();\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.display != this.props.display) this.refresh();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          widgets = _this$state.widgets,\n          layout = _this$state.layout,\n          statusBar = _this$state.statusBar;\n      var widgetLayout = widgets.map(function (widget) {\n        return {\n          i: widget._id,\n          x: widget.x || 0,\n          y: widget.y || 0,\n          w: widget.w || 1,\n          h: widget.h || 1\n        };\n      });\n      var GridLayoutWithHeight = HeightProvider(GridLayout, this.container, layout);\n      return /*#__PURE__*/React.createElement(Frame, null, /*#__PURE__*/React.createElement(\"div\", {\n        ref: function ref(_ref2) {\n          return _this3.container = _ref2;\n        },\n        className: _JSXStyle.dynamic([[\"2791563212\", [layout == 'spaced' ? 10 : 0, layout == 'spaced' ? 6 : 0]]]) + \" \" + 'gridContainer'\n      }, /*#__PURE__*/React.createElement(GridLayoutWithHeight, {\n        isDraggable: false,\n        isResizable: false,\n        layout: widgetLayout,\n        cols: 6,\n        margin: layout == 'spaced' ? [10, 10] : [0, 0],\n        className: _JSXStyle.dynamic([[\"2791563212\", [layout == 'spaced' ? 10 : 0, layout == 'spaced' ? 6 : 0]]]) + \" \" + 'layout'\n      }, widgets.map(function (widget) {\n        var Widget = Widgets[widget.type] ? Widgets[widget.type].Widget : EmptyWidget;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: widget._id,\n          className: _JSXStyle.dynamic([[\"2791563212\", [layout == 'spaced' ? 10 : 0, layout == 'spaced' ? 6 : 0]]]) + \" \" + 'widget'\n        }, /*#__PURE__*/React.createElement(Widget, {\n          data: widget.data,\n          className: _JSXStyle.dynamic([[\"2791563212\", [layout == 'spaced' ? 10 : 0, layout == 'spaced' ? 6 : 0]]])\n        }));\n      })), /*#__PURE__*/React.createElement(_JSXStyle, {\n        id: \"2791563212\",\n        dynamic: [layout == 'spaced' ? 10 : 0, layout == 'spaced' ? 6 : 0]\n      }, \".gridContainer.__jsx-style-dynamic-selector{-webkit-flex:1;-ms-flex:1;flex:1;overflow:hidden;margin-bottom:\".concat(layout == 'spaced' ? 10 : 0, \"px;}.widget.__jsx-style-dynamic-selector{border-radius:\").concat(layout == 'spaced' ? 6 : 0, \"px;overflow:hidden;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdXNlclxcRGVza3RvcFxcZGlnaXRhbHNpZ25hZ2UtbWFzdGVyICgyKVxcZGlnaXRhbHNpZ25hZ2UtbWFzdGVyXFxjb21wb25lbnRzXFxEaXNwbGF5XFxEaXNwbGF5LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW1GYSxBQUd3QixBQUtzQyxpQ0FKN0IsWUFLQSxJQUo2QixZQUsvQyxpQ0FKQSIsImZpbGUiOiJDOlxcVXNlcnNcXHVzZXJcXERlc2t0b3BcXGRpZ2l0YWxzaWduYWdlLW1hc3RlciAoMilcXGRpZ2l0YWxzaWduYWdlLW1hc3RlclxcY29tcG9uZW50c1xcRGlzcGxheVxcRGlzcGxheS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGVvdmVydmlldyBTaG93cyB0aGUgZGlzcGxheSBmcmFtZSBhbmQgcmVuZGVycyBhbGwgdGhlXG4gKiB3aWRnZXRzIGluc2lkZSBvZiBpdFxuICovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCBHcmlkTGF5b3V0IGZyb20gJ3JlYWN0LWdyaWQtbGF5b3V0J1xuaW1wb3J0IHNvY2tldElPQ2xpZW50IGZyb20gJ3NvY2tldC5pby1jbGllbnQnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgeyB2aWV3IH0gZnJvbSAncmVhY3QtZWFzeS1zdGF0ZSdcblxuaW1wb3J0IEZyYW1lIGZyb20gJy4vRnJhbWUuanMnXG5pbXBvcnQgSGVpZ2h0UHJvdmlkZXIgZnJvbSAnLi4vV2lkZ2V0cy9IZWlnaHRQcm92aWRlcidcbmltcG9ydCBXaWRnZXRzIGZyb20gJy4uLy4uL3dpZGdldHMnXG5pbXBvcnQgRW1wdHlXaWRnZXQgZnJvbSAnLi4vV2lkZ2V0cy9FbXB0eVdpZGdldCdcblxuaW1wb3J0IHsgZ2V0RGlzcGxheSB9IGZyb20gJy4uLy4uL2FjdGlvbnMvZGlzcGxheSdcblxuY29uc3QgREVGQVVMVF9TVEFUVVNfQkFSID0gW11cbmNvbnN0IERFRkFVTFRfTEFZT1VUID0gJ3NwYWNlZCdcblxuY2xhc3MgRGlzcGxheSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHdpZGdldHM6IFtdLFxuICAgICAgbGF5b3V0OiBERUZBVUxUX0xBWU9VVCxcbiAgICAgIHN0YXR1c0JhcjogREVGQVVMVF9TVEFUVVNfQkFSXG4gICAgfVxuICAgIHRoaXMudGhyb3R0bGVkUmVmcmVzaCA9IF8uZGVib3VuY2UodGhpcy5yZWZyZXNoLCAxNTAwKVxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5yZWZyZXNoKClcbiAgICBjb25zdCB7IGhvc3QgPSAnaHR0cDovL2xvY2FsaG9zdCcgfSA9IHRoaXMucHJvcHNcbiAgICBjb25zdCBzb2NrZXQgPSBzb2NrZXRJT0NsaWVudChob3N0KVxuICAgIHNvY2tldC5vbignYWRtaW46dXBkYXRlJywgKCkgPT4gdGhpcy50aHJvdHRsZWRSZWZyZXNoKCkpXG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgaWYgKHByZXZQcm9wcy5kaXNwbGF5ICE9IHRoaXMucHJvcHMuZGlzcGxheSkgdGhpcy5yZWZyZXNoKClcbiAgfVxuXG4gIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgY29uc3QgeyBkaXNwbGF5IH0gPSB0aGlzLnByb3BzXG4gICAgcmV0dXJuIGdldERpc3BsYXkoZGlzcGxheSkudGhlbigoeyB3aWRnZXRzID0gW10sIGxheW91dCwgc3RhdHVzQmFyID0gREVGQVVMVF9TVEFUVVNfQkFSIH0pID0+IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyB3aWRnZXRzLCBsYXlvdXQsIHN0YXR1c0JhciB9KVxuICAgIH0pXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyB3aWRnZXRzLCBsYXlvdXQsIHN0YXR1c0JhciB9ID0gdGhpcy5zdGF0ZVxuICAgIGNvbnN0IHdpZGdldExheW91dCA9IHdpZGdldHMubWFwKHdpZGdldCA9PiAoe1xuICAgICAgaTogd2lkZ2V0Ll9pZCxcbiAgICAgIHg6IHdpZGdldC54IHx8IDAsXG4gICAgICB5OiB3aWRnZXQueSB8fCAwLFxuICAgICAgdzogd2lkZ2V0LncgfHwgMSxcbiAgICAgIGg6IHdpZGdldC5oIHx8IDFcbiAgICB9KSlcblxuICAgIGNvbnN0IEdyaWRMYXlvdXRXaXRoSGVpZ2h0ID0gSGVpZ2h0UHJvdmlkZXIoR3JpZExheW91dCwgdGhpcy5jb250YWluZXIsIGxheW91dClcblxuICAgIHJldHVybiAoXG4gICAgICA8RnJhbWU+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXsnZ3JpZENvbnRhaW5lcid9IHJlZj17cmVmID0+ICh0aGlzLmNvbnRhaW5lciA9IHJlZil9PlxuICAgICAgICAgIDxHcmlkTGF5b3V0V2l0aEhlaWdodFxuICAgICAgICAgICAgY2xhc3NOYW1lPSdsYXlvdXQnXG4gICAgICAgICAgICBpc0RyYWdnYWJsZT17ZmFsc2V9XG4gICAgICAgICAgICBpc1Jlc2l6YWJsZT17ZmFsc2V9XG4gICAgICAgICAgICBsYXlvdXQ9e3dpZGdldExheW91dH1cbiAgICAgICAgICAgIGNvbHM9ezZ9XG4gICAgICAgICAgICBtYXJnaW49e2xheW91dCA9PSAnc3BhY2VkJyA/IFsxMCwgMTBdIDogWzAsIDBdfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt3aWRnZXRzLm1hcCh3aWRnZXQgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBXaWRnZXQgPSBXaWRnZXRzW3dpZGdldC50eXBlXSA/IFdpZGdldHNbd2lkZ2V0LnR5cGVdLldpZGdldCA6IEVtcHR5V2lkZ2V0XG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPGRpdiBrZXk9e3dpZGdldC5faWR9IGNsYXNzTmFtZT17J3dpZGdldCd9PlxuICAgICAgICAgICAgICAgICAgPFdpZGdldCBkYXRhPXt3aWRnZXQuZGF0YX0gLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSl9XG4gICAgICAgICAgPC9HcmlkTGF5b3V0V2l0aEhlaWdodD5cbiAgICAgICAgICA8c3R5bGUganN4PlxuICAgICAgICAgICAge2BcbiAgICAgICAgICAgICAgLmdyaWRDb250YWluZXIge1xuICAgICAgICAgICAgICAgIGZsZXg6IDE7XG4gICAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAke2xheW91dCA9PSAnc3BhY2VkJyA/IDEwIDogMH1weDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAud2lkZ2V0IHtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAke2xheW91dCA9PSAnc3BhY2VkJyA/IDYgOiAwfXB4O1xuICAgICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGB9XG4gICAgICAgICAgPC9zdHlsZT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L0ZyYW1lPlxuICAgIClcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB2aWV3KERpc3BsYXkpXG4iXX0= */\\n/*@ sourceURL=C:\\\\Users\\\\user\\\\Desktop\\\\digitalsignage-master (2)\\\\digitalsignage-master\\\\components\\\\Display\\\\Display.js */\"))));\n    }\n  }]);\n\n  return Display;\n}(React.Component);\n\nexport default view(Display);","map":{"version":3,"sources":["C:/Users/user/Desktop/digitalsignage-master (2)/digitalsignage-master/components/Display/Display.js"],"names":["React","GridLayout","socketIOClient","_","view","Frame","HeightProvider","Widgets","EmptyWidget","getDisplay","DEFAULT_STATUS_BAR","DEFAULT_LAYOUT","Display","props","display","then","widgets","layout","statusBar","setState","state","throttledRefresh","debounce","refresh","host","socket","on","prevProps","widgetLayout","map","widget","i","_id","x","y","w","h","GridLayoutWithHeight","container","ref","Widget","type","data","Component"],"mappings":"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","sourcesContent":["/**\n * @fileoverview Shows the display frame and renders all the\n * widgets inside of it\n */\n\nimport React from 'react'\nimport GridLayout from 'react-grid-layout'\nimport socketIOClient from 'socket.io-client'\nimport _ from 'lodash'\nimport { view } from 'react-easy-state'\n\nimport Frame from './Frame.js'\nimport HeightProvider from '../Widgets/HeightProvider'\nimport Widgets from '../../widgets'\nimport EmptyWidget from '../Widgets/EmptyWidget'\n\nimport { getDisplay } from '../../actions/display'\n\nconst DEFAULT_STATUS_BAR = []\nconst DEFAULT_LAYOUT = 'spaced'\n\nclass Display extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      widgets: [],\n      layout: DEFAULT_LAYOUT,\n      statusBar: DEFAULT_STATUS_BAR\n    }\n    this.throttledRefresh = _.debounce(this.refresh, 1500)\n  }\n\n  componentDidMount() {\n    this.refresh()\n    const { host = 'http://localhost' } = this.props\n    const socket = socketIOClient(host)\n    socket.on('admin:update', () => this.throttledRefresh())\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.display != this.props.display) this.refresh()\n  }\n\n  refresh = () => {\n    const { display } = this.props\n    return getDisplay(display).then(({ widgets = [], layout, statusBar = DEFAULT_STATUS_BAR }) => {\n      this.setState({ widgets, layout, statusBar })\n    })\n  }\n\n  render() {\n    const { widgets, layout, statusBar } = this.state\n    const widgetLayout = widgets.map(widget => ({\n      i: widget._id,\n      x: widget.x || 0,\n      y: widget.y || 0,\n      w: widget.w || 1,\n      h: widget.h || 1\n    }))\n\n    const GridLayoutWithHeight = HeightProvider(GridLayout, this.container, layout)\n\n    return (\n      <Frame>\n        <div className={'gridContainer'} ref={ref => (this.container = ref)}>\n          <GridLayoutWithHeight\n            className='layout'\n            isDraggable={false}\n            isResizable={false}\n            layout={widgetLayout}\n            cols={6}\n            margin={layout == 'spaced' ? [10, 10] : [0, 0]}\n          >\n            {widgets.map(widget => {\n              const Widget = Widgets[widget.type] ? Widgets[widget.type].Widget : EmptyWidget\n              return (\n                <div key={widget._id} className={'widget'}>\n                  <Widget data={widget.data} />\n                </div>\n              )\n            })}\n          </GridLayoutWithHeight>\n          <style jsx>\n            {`\n              .gridContainer {\n                flex: 1;\n                overflow: hidden;\n                margin-bottom: ${layout == 'spaced' ? 10 : 0}px;\n              }\n              .widget {\n                border-radius: ${layout == 'spaced' ? 6 : 0}px;\n                overflow: hidden;\n              }\n            `}\n          </style>\n        </div>\n      </Frame>\n    )\n  }\n}\n\nexport default view(Display)\n"]},"metadata":{},"sourceType":"module"}